name: gatk_tumor_only_somatic_variant_calling
description: |
  Perform variant calling on a single tumor sample using mutect2 tumor only mode.
  Run the input bam file through getpileupsummarries and then calculatecontaminationton get the contamination and segmentation tables.
  Filter the mutect2 output vcf using filtermutectcalls and the contamination & segmentation tables for additional filtering.
keywords:
  - gatk4
  - mutect2
  - getpileupsummaries
  - calculatecontamination
  - filtermutectcalls
  -picard_renamesampleinvcf
  - variant_calling
  - tumor_only
  - filtered_vcf
modules:
  - gatk4/mutect2
  - gatk4/getpileupsummaries
  - gatk4/calculatecontamination
  - gatk4/filtermutectcalls
  - picard/renamesampleinvcf
input:
  - meta:
      type: map
      description: |
        Groovy Map containing sample information
        e.g. [ id:'test' ]
  - input:
      type: list
      description: list containing the vcf, tbi and stats files generated by mutect2
  - fasta:
      type: file
      description: The reference fasta file
      pattern: "*.fasta"
  - fai:
      type: file
      description: Index of reference fasta file
      pattern: "*.fasta.fai"
  - dict:
      type: file
      description: GATK sequence dictionary
      pattern: "*.dict"
  - germline_resource:
      type: file
      description: Population vcf of germline sequencing, containing allele fractions.
      pattern: "*.vcf.gz"
  - germline_resource_tbi:
      type: file
      description: Index file for the germline resource.
      pattern: "*.vcf.gz.tbi"

output:
  - versions:
      type: file
      description: File containing software versions
      pattern: 'versions.yml'
  - pileup_table:
      type: file
      description: File containing the pileup summary table.
      pattern: "*.pileups.table"
  - contamination_table:
      type: file
      description: File containing the contamination table.
      pattern: "*.contamination.table"
  - segmentation_table:
      type: file
      description: Output table containing segmentation of tumor minor allele fractions.
      pattern: "*.segmentation.table"
  - filtered_vcf:
      type: file
      description: file containing filtered mutect2 calls.
      pattern: "*.vcf.gz"
  - filtered_tbi:
      type: file
      description: tbi file that pairs with filtered vcf.
      pattern: "*.vcf.gz.tbi"
  - filtered_stats:
      type: file
      description: file containing statistics of the filtermutectcalls run.
      pattern: "*.filteringStats.tsv"
  - renamed_vcf:
      type: file
      description: file containing renamed filtered mutect2 calls.
      pattern: "*.vcf.gz"
  - renamed_tbi:
      type: file
      description: tbi file that pairs with renamed filtered vcf.
      pattern: "*.vcf.gz.tbi"
authors:
  - '@GCJMackenzie'
